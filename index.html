<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>SQL Query Practice</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.6.2/sql-wasm.js"></script>
</head>
<body>
  <div class="container">
    <h1>ðŸ§  SQL Query Practice</h1>
    <p>Type a SELECT query and run it on sample employee data below.</p>

    <textarea id="query" placeholder="Example: SELECT * FROM employees;"></textarea>
    <button onclick="runQuery()">Run Query</button>

    <div id="output"></div>

    <footer>
      &copy; 2025 Amoolya. All rights reserved.
    </footer>
  </div>

  <script>
    let db;

    const initSql = `
      CREATE TABLE employees (id INTEGER, name TEXT, department TEXT, salary INTEGER);
      INSERT INTO employees VALUES (1, 'Alice', 'HR', 50000);
      INSERT INTO employees VALUES (2, 'Bob', 'Engineering', 75000);
      INSERT INTO employees VALUES (3, 'Charlie', 'Sales', 60000);
      INSERT INTO employees VALUES (4, 'David', 'Engineering', 80000);
      INSERT INTO employees VALUES (5, 'Eva', 'Marketing', 55000);
    `;

    initSqlJs({
      locateFile: file => `https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.6.2/${file}`
    }).then(SQL => {
      db = new SQL.Database();
      db.run(initSql);
    });

    function runQuery() {
      const query = document.getElementById("query").value.trim();
      const output = document.getElementById("output");
      output.innerHTML = "";

      try {
        if (!query.toLowerCase().startsWith("select")) {
          throw new Error("Only SELECT queries are allowed.");
        }

        const result = db.exec(query);
        if (result.length === 0) {
          output.innerHTML = "<div class='info'>Query ran successfully but returned no data.</div>";
          return;
        }

        const table = document.createElement("table");
        const thead = document.createElement("thead");
        const tbody = document.createElement("tbody");

        const headerRow = document.createElement("tr");
        result[0].columns.forEach(col => {
          const th = document.createElement("th");
          th.textContent = col;
          headerRow.appendChild(th);
        });
        thead.appendChild(headerRow);

        result[0].values.forEach(row => {
          const tr = document.createElement("tr");
          row.forEach(val => {
            const td = document.createElement("td");
            td.textContent = val;
            tr.appendChild(td);
          });
          tbody.appendChild(tr);
        });

        table.appendChild(thead);
        table.appendChild(tbody);
        output.appendChild(table);
      } catch (err) {
        output.innerHTML = `<div class="error">${err.message}</div>`;
      }
    }
  </script>
</body>
</html>
