<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>SQL Query Practice</title>
  <link rel="stylesheet" href="style.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.6.2/sql-wasm.js"></script>
</head>
<body>
  <div class="container">
    <h2>SQL Query Practice (Browser Only)</h2>
    <textarea id="query" placeholder="Write your SQL SELECT query here..."></textarea><br>
    <button onclick="runQuery()">Run Query</button>
    <div id="output"></div>
  </div>

  <script>
    let db;

    // Sample data
    const initSql = `
      CREATE TABLE employees (id INTEGER, name TEXT, salary INTEGER);
      INSERT INTO employees VALUES (1, 'Alice', 50000);
      INSERT INTO employees VALUES (2, 'Bob', 60000);
      INSERT INTO employees VALUES (3, 'Charlie', 70000);
    `;

    // Initialize database
    initSqlJs({ locateFile: file => `https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.6.2/${file}` }).then(SQL => {
      db = new SQL.Database();
      db.run(initSql);
    });

    function runQuery() {
      const query = document.getElementById("query").value;
      const output = document.getElementById("output");
      output.innerHTML = "";

      try {
        if (!query.toLowerCase().startsWith("select")) {
          throw new Error("Only SELECT queries allowed.");
        }

        const res = db.exec(query);
        if (res.length === 0) {
          output.innerHTML = "Query ran successfully (no output).";
          return;
        }

        // Build HTML table
        const table = document.createElement("table");
        const thead = document.createElement("thead");
        const tbody = document.createElement("tbody");

        // Headers
        const headerRow = document.createElement("tr");
        res[0].columns.forEach(col => {
          const th = document.createElement("th");
          th.textContent = col;
          headerRow.appendChild(th);
        });
        thead.appendChild(headerRow);

        // Data
        res[0].values.forEach(row => {
          const tr = document.createElement("tr");
          row.forEach(val => {
            const td = document.createElement("td");
            td.textContent = val;
            tr.appendChild(td);
          });
          tbody.appendChild(tr);
        });

        table.appendChild(thead);
        table.appendChild(tbody);
        output.appendChild(table);
      } catch (err) {
        output.innerHTML = `<div class="error">${err.message}</div>`;
      }
    }
  </script>
</body>
</html>
